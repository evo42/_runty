(function(d){"function"===typeof define&&define.amd?define(["jquery"],d):d(jQuery)})(function(d){d.fn.tweet=function(p){function g(b,e){if("string"===typeof b){var d=b,h;for(h in e)var f=e[h],d=d.split("{"+h+"}").join(null===f?"":f);return d}return b(e)}function k(b,e){return function(){var j=[];this.each(function(){j.push(this.replace(b,e))});return d(j)}}function l(b,e){return b.replace(m,function(b){for(var c=/^[a-z]+:/i.test(b)?b:"http://"+b,d=0;d<e.length;++d){var a=e[d];if(a.url==c&&a.expanded_url){c=
a.expanded_url;b=a.display_url;break}}return'<a href="'+c.replace(/</g,"&lt;").replace(/>/g,"^&gt;")+'">'+b.replace(/</g,"&lt;").replace(/>/g,"^&gt;")+"</a>"})}function q(){var c="https:"==document.location.protocol?"https:":"http:",d=null===b.fetch?b.count:b.fetch;if(b.list)return c+"//"+b.twitter_api_url+"/1/"+b.username[0]+"/lists/"+b.list+"/statuses.json?page="+b.page+"&per_page="+d+"&callback=?";if(b.favorites)return c+"//"+b.twitter_api_url+"/1/favorites.json?screen_name="+b.username[0]+"&page="+
b.page+"&count="+d+"&callback=?";if(null===b.query&&1==b.username.length)return c+"//"+b.twitter_api_url+"/1/statuses/user_timeline.json?screen_name="+b.username[0]+"&count="+d+(b.retweets?"&include_rts=1":"")+"&page="+b.page+"&callback=?";var j=b.query||"from:"+b.username.join(" OR from:");return c+"//"+b.twitter_search_url+"/search.json?&q="+encodeURIComponent(j)+"&rpp="+d+"&page="+b.page+"&callback=?"}function n(b,d){return d?"user"in b?b.user.profile_image_url_https:n(b,!1).replace(/^http:\/\/[a-z0-9]{1,3}\.twimg\.com\//,
"https://s3.amazonaws.com/twitter_production/"):b.profile_image_url||b.user.profile_image_url}function r(c){var e,j,h,f,a={};a.item=c;a.source=c.source;a.screen_name=c.from_user||c.user.screen_name;a.name=c.from_user_name||c.user.name;a.retweet="undefined"!=typeof c.retweeted_status;a.tweet_time=Date.parse(c.created_at.replace(/^([a-z]{3})( [a-z]{3} \d\d?)(.*)( \d{4})$/i,"$1,$2$4$3"));a.join_text="auto"==b.join_text?c.text.match(/^(@([A-Za-z0-9-_]+)) .*/i)?b.auto_join_text_reply:c.text.match(m)?b.auto_join_text_url:
c.text.match(/^((\w+ed)|just) .*/im)?b.auto_join_text_ed:c.text.match(/^(\w*ing) .*/i)?b.auto_join_text_ing:b.auto_join_text_default:b.join_text;a.tweet_id=c.id_str;a.twitter_base="http://"+b.twitter_url+"/";a.user_url=a.twitter_base+a.screen_name;a.tweet_url=a.user_url+"/status/"+a.tweet_id;a.reply_url=a.twitter_base+"intent/tweet?in_reply_to="+a.tweet_id;a.retweet_url=a.twitter_base+"intent/retweet?tweet_id="+a.tweet_id;a.favorite_url=a.twitter_base+"intent/favorite?tweet_id="+a.tweet_id;a.retweeted_screen_name=
a.retweet&&c.retweeted_status.user.screen_name;e=a.tweet_time;e=((new Date).getTime()-e)/1E3;f=parseInt(e,10);1>f&&(f=0);e=parseInt(f/86400,10);j=parseInt(f/3600,10);h=parseInt(f/60,10);f=parseInt(f,10);a.tweet_relative_time=2<e?"about "+e+" days ago":24<j?"about a day ago":2<j?"about "+j+" hours ago":45<h?"about an hour ago":2<h?"about "+h+" minutes ago":1<f?"about "+f+" seconds ago":"just now";a.entities=c.entities?(c.entities.urls||[]).concat(c.entities.media||[]):[];a.tweet_raw_text=a.retweet?
"RT @"+a.retweeted_screen_name+" "+c.retweeted_status.text:c.text;a.tweet_text=d([l(a.tweet_raw_text,a.entities)]).linkUser().linkHash()[0];a.retweeted_tweet_text=d([l(c.text,a.entities)]).linkUser().linkHash()[0];a.tweet_text_fancy=d([a.tweet_text]).makeHeart()[0];a.avatar_size=b.avatar_size;a.avatar_url=n(a.retweet?c.retweeted_status:c,"https:"===document.location.protocol);a.avatar_screen_name=a.retweet?a.retweeted_screen_name:a.screen_name;a.avatar_profile_url=a.twitter_base+a.avatar_screen_name;
a.user=g('<a class="tweet_user" href="{user_url}">{screen_name}</a>',a);a.join=b.join_text?g('<span class="tweet_join">{join_text}</span>',a):"";a.avatar=a.avatar_size?g('<a class="tweet_avatar" href="{avatar_profile_url}"><img src="{avatar_url}" height="{avatar_size}" width="{avatar_size}" alt="{avatar_screen_name}\'s avatar" title="{avatar_screen_name}\'s avatar" border="0"/></a>',a):"";a.time=g('<span class="tweet_time"><a href="{tweet_url}" title="view tweet on twitter">{tweet_relative_time}</a></span>',
a);a.text=g('<span class="tweet_text">{tweet_text_fancy}</span>',a);a.retweeted_text=g('<span class="tweet_text">{retweeted_tweet_text}</span>',a);a.reply_action=g('<a class="tweet_action tweet_reply" href="{reply_url}">reply</a>',a);a.retweet_action=g('<a class="tweet_action tweet_retweet" href="{retweet_url}">retweet</a>',a);a.favorite_action=g('<a class="tweet_action tweet_favorite" href="{favorite_url}">favorite</a>',a);return a}var b=d.extend({username:null,list:null,favorites:!1,query:null,
avatar_size:null,count:3,fetch:null,page:1,retweets:!0,intro_text:null,outro_text:null,join_text:null,auto_join_text_default:" I said, ",auto_join_text_ed:" I ",auto_join_text_ing:" I am ",auto_join_text_reply:" I replied to ",auto_join_text_url:" I was looking at ",loading_text:null,refresh_interval:null,twitter_url:"twitter.com",twitter_api_url:"api.twitter.com",twitter_search_url:"search.twitter.com",template:"{avatar}{time}{join} {text}",comparator:function(b,d){return d.tweet_time-b.tweet_time},
filter:function(){return!0}},p),m=/\b((?:https?:\/\/|www\d{0,3}[.]|[a-z0-9.\-]+[.][a-z]{2,4}\/)(?:[^\s()<>]+|\(([^\s()<>]+|(\([^\s()<>]+\)))*\))+(?:\(([^\s()<>]+|(\([^\s()<>]+\)))*\)|[^\s`!()\[\]{};:'".,<>?\u00ab\u00bb\u201c\u201d\u2018\u2019]))/gi;d.extend({tweet:{t:g}});d.fn.extend({linkUser:k(/(^|[\W])@(\w+)/gi,'$1<span class="at">@</span><a href="http://'+b.twitter_url+'/$2">$2</a>'),linkHash:k(/(?:^| )[\#]+([\w\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u00ff\u0600-\u06ff]+)/gi,' <a href="http://'+b.twitter_search_url+
"/search?q=&tag=$1&lang=all"+(b.username&&1==b.username.length&&!b.list?"&from="+b.username.join("%2BOR%2B"):"")+'" class="tweet_hashtag">#$1</a>'),makeHeart:k(/(&lt;)+[3]/gi,"<tt class='heart'>&#x2665;</tt>")});return this.each(function(c,e){b.username&&"string"==typeof b.username&&(b.username=[b.username]);d(e).unbind("tweet:render").unbind("tweet:retrieved").unbind("tweet:load").bind({"tweet:load":function(){var c=d('<p class="loading">'+b.loading_text+"</p>");b.loading_text&&d(e).not(":has(.tweet_list)").empty().append(c);
d.getJSON(q(),function(c){c=d.map(c.results||c,r);c=d.grep(c,b.filter).sort(b.comparator).slice(0,b.count);d(e).trigger("tweet:retrieved",[c])})},"tweet:retrieved":function(b,c){d(e).trigger("tweet:render",[c])},"tweet:render":function(c,h){var f=d(e),a=d('<ul class="tweet_list">');a.append(d.map(h,function(a){return"<li>"+g(b.template,a)+"</li>"}).join("")).children("li:first").addClass("tweet_first").end().children("li:odd").addClass("tweet_even").end().children("li:even").addClass("tweet_odd");
d(f).empty().append(a);b.intro_text&&a.before('<p class="tweet_intro">'+b.intro_text+"</p>");b.outro_text&&a.after('<p class="tweet_outro">'+b.outro_text+"</p>");d(f).trigger("loaded").trigger(0===h.length?"empty":"full");b.refresh_interval&&window.setTimeout(function(){d(f).trigger("tweet:load")},1E3*b.refresh_interval)}}).trigger("tweet:load")})}});