/*!
 *  GMAP3 Plugin for JQuery 
 *  Version   : 5.0b
 *  Date      : 2012-11-17
 *  Licence   : GPL v3 : http://www.gnu.org/licenses/gpl.html  
 *  Author    : DEMONTE Jean-Baptiste
 *  Contact   : jbdemonte@gmail.com
 *  Web site  : http://gmap3.net
 *   
 *  Copyright (c) 2010-2012 Jean-Baptiste DEMONTE
 *  All rights reserved.
 *   
 * Redistribution and use in source and binary forms, with or without 
 * modification, are permitted provided that the following conditions are met:
 * 
 *   - Redistributions of source code must retain the above copyright
 *     notice, this list of conditions and the following disclaimer.
 *   - Redistributions in binary form must reproduce the above 
 *     copyright notice, this list of conditions and the following 
 *     disclaimer in the documentation and/or other materials provided 
 *     with the distribution.
 *   - Neither the name of the author nor the names of its contributors 
 *     may be used to endorse or promote products derived from this 
 *     software without specific prior written permission.
 *
 * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" 
 * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE 
 * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE 
 * ARE DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE 
 * LIABLE FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR 
 * CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF 
 * SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS 
 * INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN 
 * CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) 
 * ARISING IN ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE 
 * POSSIBILITY OF SUCH DAMAGE.
 */
;(function(h,y){function G(a,c){return a!==y?a:"gmap3_"+(c?O+1:++O)}function W(a){var c=function(a){return parseInt(a,10)},d=google.maps.version.split(".").map(c);a=a.split(".").map(c);for(c=0;c<a.length;c++)if(d.hasOwnProperty(c)){if(d[c]<a[c])return!1}else return!1;return!0}function A(a,c,d,f,g){if(c.todo.events||c.todo.onces){var j={id:f,data:c.todo.data,tag:c.todo.tag};c.todo.events&&h.each(c.todo.events,function(c,f){var q=a,l=f;h.isArray(f)&&(q=f[0],l=f[1]);google.maps.event.addListener(d,c,
function(a){l.apply(q,[g?g:d,a,j])})});c.todo.onces&&h.each(c.todo.onces,function(c,f){var q=a,l=f;h.isArray(f)&&(q=f[0],l=f[1]);google.maps.event.addListenerOnce(d,c,function(a){l.apply(q,[g?g:d,a,j])})})}}function X(){var a=[];this.empty=function(){return!a.length};this.add=function(c){a.push(c)};this.get=function(){return a.length?a[0]:!1};this.ack=function(){a.shift()}}function Y(a,c,d){function f(){for(var a in d)if(!(a in g))return a}var g={},j=this,e,x={map:!1,marker:!1,infowindow:!1,circle:!1,
overlay:!1,getlatlng:!1,getmaxzoom:!1,getelevation:!1,streetviewpanorama:!1,getaddress:!0},q={getgeoloc:!0};if("string"===typeof d){var l={};l[d]={};d=l}this.run=function(){for(var j,l;j=f();){if("function"===typeof a[j]){e=j;l=h.extend(!0,{},t[j]||{},d[j].options||{});j in x?d[j].values?Z(d[j].values,a,a[j],{todo:d[j],opts:l,session:g}):K(a,a[j],x[j],{todo:d[j],opts:l,session:g}):j in q?$(a,a[j],{todo:d[j],opts:l,session:g}):a[j].apply(a,[{todo:d[j],opts:l,session:g}]);return}g[j]=null}c.apply(a,
[d,g])};this.ack=function(a){g[e]=a;j.run.apply(j,[])}}function P(a){var c,d=[];for(c in a)d.push(c);return d}function E(a,c){var d={};if(a.todo)for(var f in a.todo)"options"!==f&&"values"!==f&&(d[f]=a.todo[f]);var g=["data","tag","id","events","onces"];for(f=0;f<g.length;f++)aa(d,g[f],c,a.todo);d.options=h.extend({},a.opts||{},c.options||{});return d}function aa(a,c){for(var d=2;d<arguments.length;d++)if(c in arguments[d]){a[c]=arguments[d][c];break}}function F(a,c,d,f){var g=this,j=[];t.classes.OverlayView.call(this);
this.setMap(a);this.onAdd=function(){var a=this.getPanes();c.pane in a&&h(a[c.pane]).append(f);h.each("dblclick click mouseover mousemove mouseout mouseup mousedown".split(" "),function(a,d){j.push(google.maps.event.addDomListener(f[0],d,function(a){h.Event(a).stopPropagation();google.maps.event.trigger(g,d,[a]);g.draw()}))});j.push(google.maps.event.addDomListener(f[0],"contextmenu",function(a){h.Event(a).stopPropagation();google.maps.event.trigger(g,"rightclick",[a]);g.draw()}))};this.getPosition=
function(){return d};this.draw=function(){var a=this.getProjection().fromLatLngToDivPixel(d);f.css("left",a.x+c.offset.x+"px").css("top",a.y+c.offset.y+"px")};this.onRemove=function(){for(var a=0;a<j.length;a++)google.maps.event.removeListener(j[a]);f.remove()};this.hide=function(){f.hide()};this.show=function(){f.show()};this.toggle=function(){f&&(f.is(":visible")?this.show():this.hide())};this.toggleDOM=function(){this.getMap()?this.setMap(null):this.setMap(a)};this.getDOMElement=function(){return f[0]}}
function ba(a,c,d){function f(b){m[b]||(delete n[b].options.map,m[b]=new t.classes.Marker(n[b].options),A(a,{todo:n[b]},m[b],n[b].id))}function g(){(H=Q.getProjection())?(p=!0,B.push(google.maps.event.addListener(c,"zoom_changed",function(){e()})),B.push(google.maps.event.addListener(c,"bounds_changed",function(){e()})),x()):setTimeout(function(){g.apply(k,[])},25)}function j(b){"object"===typeof v[b]?("function"===typeof v[b].obj.setMap&&v[b].obj.setMap(null),"function"===typeof v[b].obj.remove&&
v[b].obj.remove(),"function"===typeof v[b].shadow.remove&&v[b].obj.remove(),"function"===typeof v[b].shadow.setMap&&v[b].shadow.setMap(null),delete v[b].obj,delete v[b].shadow):m[b]&&m[b].setMap(null);delete v[b]}function e(){clearTimeout(R);R=setTimeout(function(){x()},25)}function x(){if(!q&&!s&&p){var a=[],g={},k=c.getZoom(),f="maxZoom"in d&&k>d.maxZoom,B={},e;for(e in v)B[e]=!0;var m=!1,r,D;l=!1;3<k&&(k=c.getCenter(),e=c.getBounds().getNorthEast(),k instanceof google.maps.LatLng?(r=k.lat(),m=
k.lng(),e instanceof google.maps.LatLng?(k=e.lat(),e=e.lng()):(k=e,e=void 0)):(r=k,m=e,e=k=void 0),r=Math.PI*r/180,m=Math.PI*m/180,k=Math.PI*k/180,e=Math.PI*e/180,k=6371E3*Math.acos(Math.min(Math.cos(r)*Math.cos(k)*Math.cos(m)*Math.cos(e)+Math.cos(r)*Math.sin(m)*Math.cos(k)*Math.sin(e)+Math.sin(r)*Math.sin(k),1)),r=(new google.maps.Circle({center:c.getCenter(),radius:1.25*k})).getBounds(),m=r.getSouthWest().lng()<r.getNorthEast().lng());for(e=0;e<n.length;e++)n[e]&&((!m||r.contains(n[e].options.position))&&
(!L||L(C[e])))&&a.push(e);for(;;){for(e=0;g[e]&&e<a.length;)e++;if(e==a.length)break;k=[];if(b&&!f){D=n[a[e]].options.position;m=H.fromLatLngToDivPixel(D);r=H.fromDivPixelToLatLng(new google.maps.Point(m.x+d.radius,m.y-d.radius));m=H.fromDivPixelToLatLng(new google.maps.Point(m.x-d.radius,m.y+d.radius));for(r=new google.maps.LatLngBounds(m,r);e<a.length;e++)g[e]||r.contains(n[a[e]].options.position)&&k.push(e)}else for(;e<a.length;e++)if(!g[e]){k.push(e);break}r={indexes:[],ref:[]};for(e=0;e<k.length;e++)g[k[e]]=
!0,r.indexes.push(a[k[e]]),r.ref.push(a[k[e]]);r.latLng=D;r.ref=r.ref.join("-");r.ref in B?delete B[r.ref]:(1===k.length&&(v[r.ref]=!0),function(b){setTimeout(function(){S(b)},1)}(r))}h.each(B,function(b){j(b)});s=!1}}var q=!1,l=!1,s=!1,p=!1,b=!0,k=this,B=[],v={},r={},D={},m=[],n=[],C=[],Q,y=c,u=function(){this.onAdd=function(){};this.onRemove=function(){};this.draw=function(){};return t.classes.OverlayView.apply(this,[])};u.prototype=t.classes.OverlayView.prototype;u=new u;u.setMap(y);Q=u;var R,
H,L,S;g();this.getById=function(b){return b in r?(f(r[b]),m[r[b]]):!1};this.rm=function(b){var a=r[b];m[a]&&m[a].setMap(null);delete m[a];m[a]=!1;delete n[a];n[a]=!1;delete C[a];C[a]=!1;delete r[b];delete D[a];l=!0};this.clearById=function(b){if(b in r)return this.rm(b),!0};this.clear=function(b,a,g){var k,d,c=[],f=I(g);b?(k=n.length-1,d=g=-1):(k=0,g=n.length,d=1);for(;k!=g;k+=d)if(n[k]&&(!f||f(n[k].tag)))if(c.push(D[k]),a||b)break;for(b=0;b<c.length;b++)this.rm(c[b])};this.add=function(b,a){b.id=
G(b.id);this.clearById(b.id);r[b.id]=m.length;D[m.length]=b.id;m.push(null);n.push(b);C.push(a);l=!0};this.addMarker=function(b,k){k=k||{};k.id=G(k.id);this.clearById(k.id);k.options||(k.options={});k.options.position=b.getPosition();A(a,{todo:k},b,k.id);r[k.id]=m.length;D[m.length]=k.id;m.push(b);n.push(k);C.push(k.data||{});l=!0};this.todo=function(b){return n[b]};this.value=function(b){return C[b]};this.marker=function(b){return b in m?(f(b),m[b]):!1};this.markerIsSet=function(b){return Boolean(m[b])};
this.setMarker=function(b,a){m[b]=a};this.store=function(b,a,k){v[b.ref]={obj:a,shadow:k}};this.free=function(){for(var b=0;b<B.length;b++)google.maps.event.removeListener(B[b]);B=[];h.each(v,function(b){j(b)});v={};h.each(n,function(b){n[b]=null});n=[];h.each(m,function(b){m[b]&&(m[b].setMap(null),delete m[b])});m=[];h.each(C,function(b){delete C[b]});C=[];r={};D={}};this.filter=function(b){L=b;x()};this.enable=function(a){b!=a&&(b=a,x())};this.display=function(b){S=b};this.error=function(){};this.beginUpdate=
function(){q=!0};this.endUpdate=function(){q=!1;l&&x()};this.autofit=function(b){for(var a=0;a<n.length;a++)n[a]&&b.extend(n[a].options.position)}}function M(a,c){this.id=function(){return a};this.filter=function(a){c.filter(a)};this.enable=function(){c.enable(!0)};this.disable=function(){c.enable(!1)};this.add=function(a,f,g){g||c.beginUpdate();c.addMarker(a,f);g||c.endUpdate()};this.getById=function(a){return c.getById(a)};this.clearById=function(a,f){var g;f||c.beginUpdate();g=c.clearById(a);f||
c.endUpdate();return g};this.clear=function(a,f,g,j){j||c.beginUpdate();c.clear(a,f,g);j||c.endUpdate()}}function ca(){function a(a){return{id:a.id,name:a.name,object:a.obj,tag:a.tag,data:a.data}}function c(a){"function"===typeof a.setMap&&a.setMap(null);"function"===typeof a.remove&&a.remove();"function"===typeof a.free&&a.free()}var d={},f={};this.add=function(a,c,e,h){a=a.todo||{};var q=G(a.id);d[c]||(d[c]=[]);q in f&&this.clearById(q);f[q]={obj:e,sub:h,name:c,id:q,tag:a.tag,data:a.data};d[c].push(q);
return q};this.getById=function(g,c,d){return g in f?c?f[g].sub:d?a(f[g]):f[g].obj:!1};this.get=function(g,c,e,h){var q,l=I(e);if(!d[g]||!d[g].length)return null;for(e=d[g].length;e;)if(e--,(q=d[g][c?e:d[g].length-e-1])&&f[q]&&(!l||l(f[q].tag)))return h?a(f[q]):f[q].obj;return null};this.all=function(g,c,e){var h=[],q=I(c);c=function(g){var c,j;for(c=0;c<d[g].length;c++)if((j=d[g][c])&&f[j]&&(!q||q(f[j].tag)))h.push(e?a(f[j]):f[j].obj)};if(g in d)c(g);else if(g===y)for(g in d)c(g);return h};this.rm=
function(a,c,e){var h;if(!d[a])return!1;if(c)if(e)for(e=d[a].length-1;0<=e&&!(h=d[a][e],c(f[h].tag));e--);else for(e=0;e<d[a].length&&!(h=d[a][e],c(f[h].tag));e++);else e=e?d[a].length-1:0;return!(e in d[a])?!1:this.clearById(d[a][e],e)};this.clearById=function(a,j){if(a in f){var e,h=f[a].name;for(e=0;j===y&&e<d[h].length;e++)a===d[h][e]&&(j=e);c(f[a].obj);f[a].sub&&c(f[a].sub);delete f[a];d[h].splice(j,1);return!0}return!1};this.objGetById=function(a){var c;if(d.clusterer)for(var e in d.clusterer)if(!1!==
(c=f[d.clusterer[e]].obj.getById(a)))return c;return!1};this.objClearById=function(a){if(d.clusterer)for(var c in d.clusterer)if(f[d.clusterer[c]].obj.clearById(a))return!0;return null};this.clear=function(a,c,f,h){var q,l;h=I(h);if(!a||!a.length)for(q in a=[],d)a.push(q);else a=z(a);for(q=0;q<a.length;q++)if(l=a[q],c)this.rm(l,h,!0);else if(f)this.rm(l,h,!1);else for(;this.rm(l,h,!1););};this.objClear=function(a,c,e,p){if(d.clusterer&&(0<=h.inArray("marker",a)||!a.length))for(var q in d.clusterer)f[d.clusterer[q]].obj.clear(c,
e,p)}}function T(){u.elevationService||(u.elevationService=new google.maps.ElevationService);return u.elevationService}function U(){if(t.verbose){var a,c=[];if(window.console&&"function"===typeof console.error){for(a=0;a<arguments.length;a++)c.push(arguments[a]);console.error.apply(console,c)}else{c="";for(a=0;a<arguments.length;a++)c+=arguments[a].toString()+" ";alert(c)}}}function N(a){return("number"===typeof a||"string"===typeof a)&&""!==a&&!isNaN(a)}function z(a){var c,d=[];if(a!==y)if("object"===
typeof a)if("number"===typeof a.length)d=a;else for(c in a)d.push(a[c]);else d.push(a);return d}function I(a){if(a){if("function"===typeof a)return a;a=z(a);return function(c){if(c===y)return!1;if("object"===typeof c){for(var d=0;d<c.length;d++)if(0<=h.inArray(c[d],a))return!0;return!1}return 0<=h.inArray(c,a)}}}function p(a,c,d){c=c?a:null;return!a||"string"===typeof a?c:a.latLng?p(a.latLng):a instanceof google.maps.LatLng?a:N(a.lat)?new google.maps.LatLng(a.lat,a.lng):!d&&h.isArray(a)?!N(a[0])||
!N(a[1])?c:new google.maps.LatLng(a[0],a[1]):c}function J(a){var c,d;if(!a||a instanceof google.maps.LatLngBounds)return a||null;h.isArray(a)?2==a.length?(c=p(a[0]),d=p(a[1])):4==a.length&&(c=p([a[0],a[1]]),d=p([a[2],a[3]])):"ne"in a&&"sw"in a?(c=p(a.ne),d=p(a.sw)):"n"in a&&("e"in a&&"s"in a&&"w"in a)&&(c=p([a.n,a.e]),d=p([a.s,a.w]));return c&&d?new google.maps.LatLngBounds(d,c):null}function K(a,c,d,f,g){var h=d?p(f.todo,!1,!0):!1,e=h?{latLng:h}:f.todo.address?"string"===typeof f.todo.address?{address:f.todo.address}:
f.todo.address:!1,h=e?V.get(e):!1,x=this;e?(g=g||0,h?(f.latLng=h.results[0].geometry.location,f.results=h.results,f.status=h.status,c.apply(a,[f])):(e.location&&(e.location=p(e.location)),e.bounds&&(e.bounds=J(e.bounds)),u.geocoder||(u.geocoder=new google.maps.Geocoder),u.geocoder.geocode(e,function(h,j){j===google.maps.GeocoderStatus.OK?(V.store(e,{results:h,status:j}),f.latLng=h[0].geometry.location,f.results=h,f.status=j,c.apply(a,[f])):j===google.maps.GeocoderStatus.OVER_QUERY_LIMIT&&g<t.queryLimit.attempt?
setTimeout(function(){K.apply(x,[a,c,d,f,g+1])},t.queryLimit.delay+Math.floor(Math.random()*t.queryLimit.random)):(U("geocode failed",j,e),f.latLng=f.results=!1,f.status=j,c.apply(a,[f]))}))):(f.latLng=p(f.todo,!1,!0),c.apply(a,[f]))}function Z(a,c,d,f){function g(){do e++;while(e<a.length&&!("address"in a[e]));e>=a.length?d.apply(c,[f]):K(j,function(c){delete c.todo;h.extend(a[e],c);g.apply(j,[])},!0,{todo:a[e]})}var j=this,e=-1;g()}function $(a,c,d){var f=!1;navigator&&navigator.geolocation?navigator.geolocation.getCurrentPosition(function(g){f||
(f=!0,d.latLng=new google.maps.LatLng(g.coords.latitude,g.coords.longitude),c.apply(a,[d]))},function(){f||(f=!0,d.latLng=!1,c.apply(a,[d]))},d.opts.getCurrentPosition):(d.latLng=!1,c.apply(a,[d]))}function da(a){function c(){!w&&(w=q.get())&&w.run()}function d(){w=null;q.ack();c.call(x)}function f(b){if(b.todo.callback){var k=Array.prototype.slice.call(arguments,1);"function"===typeof b.todo.callback?b.todo.callback.apply(a,k):h.isArray(b.todo.callback)&&"function"===typeof b.todo.callback[1]&&b.todo.callback[1].apply(b.todo.callback[0],
k)}}function g(b,k,c){c&&A(a,b,k,c);f(b,k);w.ack(k)}function j(b,k){k=k||{};if(s)k.todo&&k.todo.options&&(k.todo.options.center&&(k.todo.options.center=p(k.todo.options.center)),s.setOptions(k.todo.options));else{var c=k.opts||h.extend(!0,{},t.map,k.todo&&k.todo.options?k.todo.options:{});c.center=b||p(c.center);s=new t.classes.Map(a.get(0),c)}}function e(b,k,c){var f=[],d="values"in b.todo;d||(b.todo.values=[{options:b.opts}]);b.todo.values.length?(j(),h.each(b.todo.values,function(d,g){var e,r,
j=E(b,g);if(j.options[c])if(j.options[c][0][0]&&h.isArray(j.options[c][0][0]))for(e=0;e<j.options[c].length;e++)for(r=0;r<j.options[c][e].length;r++)j.options[c][e][r]=p(j.options[c][e][r]);else for(e=0;e<j.options[c].length;e++)j.options[c][e]=p(j.options[c][e]);j.options.map=s;r=new google.maps[k](j.options);f.push(r);e=l.add({todo:j},k.toLowerCase(),r);A(a,{todo:j},r,e)}),g(b,d?f:f[0])):g(b,!1)}var x=this,q=new X,l=new ca,s=null,w;this._plan=function(b){for(var a=0;a<b.length;a++)q.add(new Y(x,
d,b[a]));c()};this.map=function(b){j(b.latLng,b);A(a,b,s);g(b,s)};this.destroy=function(b){l.clear();a.empty();s&&(s=null);g(b,!0)};this.infowindow=function(b){var c=[],f="values"in b.todo;f||(b.latLng&&(b.opts.position=b.latLng),b.todo.values=[{options:b.opts}]);h.each(b.todo.values,function(d,e){var g,h,n=E(b,e);n.options.position=n.options.position?p(n.options.position):p(e.latLng);s||j(n.options.position);if((h=new t.classes.InfoWindow(n.options))&&(n.open===y||n.open))f?h.open(s,n.anchor?n.anchor:
y):h.open(s,n.anchor?n.anchor:b.latLng?y:b.session.marker?b.session.marker:y);c.push(h);g=l.add({todo:n},"infowindow",h);A(a,{todo:n},h,g)});g(b,f?c:c[0])};this.circle=function(b){var c=[],f="values"in b.todo;f||(b.opts.center=b.latLng||p(b.opts.center),b.todo.values=[{options:b.opts}]);b.todo.values.length?(h.each(b.todo.values,function(f,d){var e,g,h=E(b,d);h.options.center=h.options.center?p(h.options.center):p(d);s||j(h.options.center);h.options.map=s;g=new t.classes.Circle(h.options);c.push(g);
e=l.add({todo:h},"circle",g);A(a,{todo:h},g,e)}),g(b,f?c:c[0])):g(b,!1)};this.overlay=function(b,c){var f=[],d="values"in b.todo;d||(b.todo.values=[{latLng:b.latLng,options:b.opts}]);if(b.todo.values.length){F.__initialised||(F.prototype=new t.classes.OverlayView,F.__initialised=!0);h.each(b.todo.values,function(d,e){var g,j,v=E(b,e);g=h(document.createElement("div")).css({border:"none",borderWidth:"0px",position:"absolute"});g.append(v.options.content);j=new F(s,v.options,p(v)||p(e),g);f.push(j);
c||(g=l.add(b,"overlay",j),A(a,{todo:v},j,g))});if(c)return f[0];g(b,d?f:f[0])}else g(b,!1)};this.getaddress=function(b){f(b,b.results,b.status);w.ack()};this.getlatlng=function(b){f(b,b.results,b.status);w.ack()};this.getmaxzoom=function(b){u.maxZoomService||(u.maxZoomService=new google.maps.MaxZoomService);u.maxZoomService.getMaxZoomAtLatLng(b.latLng,function(a){f(b,a.status===google.maps.MaxZoomStatus.OK?a.zoom:!1,status);w.ack()})};this.getelevation=function(b){var a,c=[],d=function(a,c){f(b,
c===google.maps.ElevationStatus.OK?a:!1,c);w.ack()};if(b.latLng)c.push(b.latLng);else{c=z(b.todo.locations||[]);for(a=0;a<c.length;a++)c[a]=p(c[a])}if(c.length)T().getElevationForLocations({locations:c},d);else{if(b.todo.path&&b.todo.path.length)for(a=0;a<b.todo.path.length;a++)c.push(p(b.todo.path[a]));c.length?T().getElevationAlongPath({path:c,samples:b.todo.samples},d):w.ack()}};this.defaults=function(b){h.each(b.todo,function(b,a){t[b]="object"===typeof t[b]?h.extend({},t[b],a):a});w.ack(!0)};
this.rectangle=function(b){var c=[],f="values"in b.todo;f||(b.todo.values=[{options:b.opts}]);b.todo.values.length?(h.each(b.todo.values,function(f,d){var g,e,h=E(b,d);h.options.bounds=h.options.bounds?J(h.options.bounds):J(d);s||j(h.options.bounds.getCenter());h.options.map=s;e=new t.classes.Rectangle(h.options);c.push(e);g=l.add({todo:h},"rectangle",e);A(a,{todo:h},e,g)}),g(b,f?c:c[0])):g(b,!1)};this.polyline=function(b){e(b,"Polyline","path")};this.polygon=function(b){e(b,"Polygon","paths")};this.trafficlayer=
function(b){j();var a=l.get("trafficlayer");a||(a=new t.classes.TrafficLayer,a.setMap(s),l.add(b,"trafficlayer",a));g(b,a)};this.bicyclinglayer=function(b){j();var a=l.get("bicyclinglayer");a||(a=new t.classes.BicyclingLayer,a.setMap(s),l.add(b,"bicyclinglayer",a));g(b,a)};this.groundoverlay=function(b){b.opts.bounds=J(b.opts.bounds);b.opts.bounds&&j(b.opts.bounds.getCenter());var a,c=new t.classes.GroundOverlay(b.opts.url,b.opts.bounds,b.opts.opts);c.setMap(s);a=l.add(b,"groundoverlay",c);g(b,c,
a)};this.streetviewpanorama=function(b){b.opts.opts||(b.opts.opts={});b.latLng?b.opts.opts.position=b.latLng:b.opts.opts.position&&(b.opts.opts.position=p(b.opts.opts.position));b.todo.divId?b.opts.container=document.getElementById(b.todo.divId):b.opts.container&&(b.opts.container=h(b.opts.container).get(0));var a,c=new t.classes.StreetViewPanorama(b.opts.container,b.opts.opts);c&&s.setStreetView(c);a=l.add(b,"streetviewpanorama",c);g(b,c,a)};this.kmllayer=function(b){var c=[],f="values"in b.todo;
f||(b.todo.values=[{options:b.opts}]);b.todo.values.length?(h.each(b.todo.values,function(f,d){var e,g,h=E(b,d);s||j();e=h.options;h.options.opts&&(e=h.options.opts,h.options.url&&(e.url=h.options.url));e.map=s;g=W("3.10")?new t.classes.KmlLayer(e):new t.classes.KmlLayer(e.url,e);c.push(g);e=l.add({todo:h},"kmllayer",g);A(a,{todo:h},g,e)}),g(b,f?c:c[0])):g(b,!1)};this.panel=function(b){j();var c,f=c=0,d,e=h(document.createElement("div"));e.css({position:"absolute",zIndex:1E3,visibility:"hidden"});
b.opts.content&&(d=h(b.opts.content),e.append(d),a.first().prepend(e),b.opts.left!==y?c=b.opts.left:b.opts.right!==y?c=a.width()-d.width()-b.opts.right:b.opts.center&&(c=(a.width()-d.width())/2),b.opts.top!==y?f=b.opts.top:b.opts.bottom!==y?f=a.height()-d.height()-b.opts.bottom:b.opts.middle&&(f=(a.height()-d.height())/2),e.css({top:f,left:c,visibility:"visible"}));c=l.add(b,"panel",e);g(b,e,c)};this.marker=function(b){var c="values"in b.todo,f=!s;c||(b.opts.position=b.latLng||p(b.opts.position),
b.todo.values=[{options:b.opts}]);if(b.todo.values.length)if(f&&j(),b.todo.cluster&&!s.getBounds())google.maps.event.addListenerOnce(s,"bounds_changed",function(){x.marker.apply(x,[b])});else if(b.todo.cluster){var d,e;if(b.todo.cluster instanceof M)d=b.todo.cluster,e=l.getById(d.id(),!0);else{var q=b.todo.cluster,m=new ba(a,s,q),n={},u={},w=[],c=/^[0-9]+$/,z;for(d in q)c.test(d)?(w.push(1*d),u[d]=q[d],u[d].width=u[d].width||0,u[d].height=u[d].height||0):n[d]=q[d];w.sort(function(b,a){return b>a});
z=n.calculator?function(b){var c=[];h.each(b,function(b,a){c.push(m.value(a))});return n.calculator.apply(a,[c])}:function(b){return b.length};m.error(function(){U.apply(x,arguments)});m.display(function(b){var c,d,f,e;f=z(b.indexes);if(q.force||1<f)for(c=0;c<w.length;c++)w[c]<=f&&(d=u[w[c]]);d?(e=d.offset||[-d.width/2,-d.height/2],c=h.extend({},n),c.options=h.extend({pane:"overlayLayer",content:d.content?d.content.replace("CLUSTER_COUNT",f):"",offset:{x:("x"in e?e.x:e[0])||0,y:("y"in e?e.y:e[1])||
0}},n.options||{}),f=x.overlay({todo:c,opts:c.options,latLng:p(b)},!0),c.options.pane="floatShadow",c.options.content=h(document.createElement("div")).width(d.width+"px").height(d.height+"px").css({cursor:"pointer"}),shadow=x.overlay({todo:c,opts:c.options,latLng:p(b)},!0),n.data={latLng:p(b),markers:[]},h.each(b.indexes,function(b,a){n.data.markers.push(m.value(a));m.markerIsSet(a)&&m.marker(a).setMap(null)}),A(a,{todo:n},shadow,y,{main:f,shadow:shadow}),m.store(b,f,shadow)):h.each(b.indexes,function(b,
a){m.marker(a).setMap(s)})});e=m;d=new M(G(b.todo.id,!0),e);l.add(b,"clusterer",d,e)}e.beginUpdate();h.each(b.todo.values,function(a,c){var d=E(b,c);d.options.position=d.options.position?p(d.options.position):p(c);d.options.map=s;f&&(s.setCenter(d.options.position),f=!1);e.add(d,c)});e.endUpdate();g(b,d)}else{var F=[];h.each(b.todo.values,function(c,d){var e,g,h=E(b,d);h.options.position=h.options.position?p(h.options.position):p(d);h.options.map=s;f&&(s.setCenter(h.options.position),f=!1);g=new t.classes.Marker(h.options);
F.push(g);e=l.add({todo:h},"marker",g);A(a,{todo:h},g,e)});g(b,c?F:F[0])}else g(b,!1)};this.getroute=function(b){b.opts.origin=p(b.opts.origin,!0);b.opts.destination=p(b.opts.destination,!0);u.directionsService||(u.directionsService=new google.maps.DirectionsService);u.directionsService.route(b.opts,function(a,c){f(b,c==google.maps.DirectionsStatus.OK?a:!1,c);w.ack()})};this.directionsrenderer=function(b){b.opts.map=s;var a,c=new google.maps.DirectionsRenderer(b.opts);b.todo.divId?c.setPanel(document.getElementById(b.todo.divId)):
b.todo.container&&c.setPanel(h(b.todo.container).get(0));a=l.add(b,"directionrenderer",c);g(b,c,a)};this.getgeoloc=function(b){g(b,b.latLng)};this.styledmaptype=function(b){j();var a=new t.classes.StyledMapType(b.todo.styles,b.opts);s.mapTypes.set(b.todo.id,a);g(b,a)};this.imagemaptype=function(b){j();var a=new t.classes.ImageMapType(b.opts);s.mapTypes.set(b.todo.id,a);g(b,a)};this.autofit=function(b){var a=new google.maps.LatLngBounds;h.each(l.all(),function(b,c){c.getPosition?a.extend(c.getPosition()):
c.getBounds?(a.extend(c.getBounds().getNorthEast()),a.extend(c.getBounds().getSouthWest())):c.getPaths?c.getPaths().forEach(function(b){b.forEach(function(b){a.extend(b)})}):c.getPath?c.getPath().forEach(function(b){a.extend(b);""}):c.getCenter?a.extend(c.getCenter()):c instanceof M&&(c=l.getById(c.id(),!0))&&c.autofit(a)});if(!a.isEmpty()&&(!s.getBounds()||!s.getBounds().equals(a)))"maxZoom"in b.todo&&google.maps.event.addListenerOnce(s,"bounds_changed",function(){this.getZoom()>b.todo.maxZoom&&
this.setZoom(b.todo.maxZoom)}),s.fitBounds(a);g(b,!0)};this.clear=function(b){if("string"===typeof b.todo){if(l.clearById(b.todo)||l.objClearById(b.todo)){g(b,!0);return}b.todo={name:b.todo}}b.todo.id?h.each(z(b.todo.id),function(b,a){l.clearById(a)||l.objClearById(a)}):(l.clear(z(b.todo.name),b.todo.last,b.todo.first,b.todo.tag),l.objClear(z(b.todo.name),b.todo.last,b.todo.first,b.todo.tag));g(b,!0)};this.exec=function(b){var c=this;h.each(z(b.todo.func),function(d,f){h.each(c.get(b.todo,!0,b.todo.hasOwnProperty("full")?
b.todo.full:!0),function(b,c){f.call(a,c)})});g(b,!0)};this.get=function(b,a,c){var d,f,e=a?b:b.todo;a||(c=e.full);"string"===typeof e?(f=l.getById(e,!1,c)||l.objGetById(e),!1===f&&(d=e,e={})):d=e.name;"map"===d&&(f=s);f||(f=[],e.id?(h.each(z(e.id),function(b,a){f.push(l.getById(a,!1,c)||l.objGetById(a))}),h.isArray(e.id)||(f=f[0])):(h.each(d?z(d):[y],function(b,a){var d;e.first?(d=l.get(a,!1,e.tag,c))&&f.push(d):e.all?h.each(l.all(a,e.tag,c),function(b,a){f.push(a)}):(d=l.get(a,!0,e.tag,c))&&f.push(d)}),
!e.all&&!h.isArray(d)&&(f=f[0])));f=h.isArray(f)||!e.all?f:[f];if(a)return f;g(b,f)};this.getdistance=function(b){var a;b.opts.origins=z(b.opts.origins);for(a=0;a<b.opts.origins.length;a++)b.opts.origins[a]=p(b.opts.origins[a],!0);b.opts.destinations=z(b.opts.destinations);for(a=0;a<b.opts.destinations.length;a++)b.opts.destinations[a]=p(b.opts.destinations[a],!0);u.distanceMatrixService||(u.distanceMatrixService=new google.maps.DistanceMatrixService);u.distanceMatrixService.getDistanceMatrix(b.opts,
function(a,c){f(b,c===google.maps.DistanceMatrixStatus.OK?a:!1,c);w.ack()})};this.trigger=function(a){if("string"===typeof a.todo)google.maps.event.trigger(s,a.todo);else{var c=[s,a.todo.eventName];a.todo.var_args&&h.each(a.todo.var_args,function(a,b){c.push(b)});google.maps.event.trigger.apply(google.maps.event,c)}f(a);w.ack()}}var t,O=0,u={},V=new function(){var a=[];this.get=function(c){if(a.length){var d,f,g,h,e,p=P(c);for(d=0;d<a.length;d++){h=a[d];e=p.length==h.keys.length;for(f=0;f<p.length&&
e;f++)g=p[f],(e=g in h.request)&&(e="object"===typeof c[g]&&"equals"in c[g]&&"function"===typeof c[g]?c[g].equals(h.request[g]):c[g]===h.request[g]);if(e)return h.results}}};this.store=function(c,d){a.push({request:c,keys:P(c),results:d})}};h.fn.gmap3=function(){var a,c=[],d=[];t||(t={verbose:!1,queryLimit:{attempt:5,delay:250,random:250},classes:{Map:google.maps.Map,Marker:google.maps.Marker,InfoWindow:google.maps.InfoWindow,Circle:google.maps.Circle,Rectangle:google.maps.Rectangle,OverlayView:google.maps.OverlayView,
StreetViewPanorama:google.maps.StreetViewPanorama,KmlLayer:google.maps.KmlLayer,TrafficLayer:google.maps.TrafficLayer,BicyclingLayer:google.maps.BicyclingLayer,GroundOverlay:google.maps.GroundOverlay,StyledMapType:google.maps.StyledMapType,ImageMapType:google.maps.ImageMapType},map:{mapTypeId:google.maps.MapTypeId.ROADMAP,center:[46.578498,2.457275],zoom:2},overlay:{pane:"floatPane",content:"",offset:{x:0,y:0}},geoloc:{getCurrentPosition:{maximumAge:6E4,timeout:5E3}}});for(a=0;a<arguments.length;a++)arguments[a]&&
c.push(arguments[a]);c.length||c.push("map");h.each(this,function(){var a=h(this),g=a.data("gmap3");g||(g=new da(a),a.data("gmap3",g));if(a=1===c.length)if(!(a="get"===c[0]))a:{var a=c[0],j;if("object"===!typeof a||!a.hasOwnProperty("get"))a=!1;else{for(j in a)if("get"!==j){a=!1;break a}a=!a.get.hasOwnProperty("callback")}}a?"get"===c[0]?d.push(g.get("map",!0)):d.push(g.get(c[0].get,!0,c[0].get.full)):g._plan(c)});return d.length?1===d.length?d[0]:d:this}})(jQuery);